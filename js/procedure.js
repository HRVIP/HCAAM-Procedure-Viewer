const proc = {
  'PROCEDURE': [{
    'text': '1.  ADDRESS GENERATOR SAFETY PRECAUTIONS',
    'subtasks': [{
      'caption': '1.1.    Turn Engine Switch → OFF (Audible Call Out)',
      'text': '/img/figures/EngineSwitch.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '1.1.1.  Once the OFF position is engaged, confirm it by clearly stating \'Engine Switch off\'.',
    },
    {
      'caption': '1.2.    Unplug all power cords from the Control Panel (Audible Call Out)',
      'text': '/img/figures/ControlPanel.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '1.2.1.  Once all power chords are disconnected, confirm it by clearly stating \'Control Panel cleared\'.',
    },
    {
      'caption': '1.3.    Turn Fuel Breather Valve Lever → OFF (Audible Call Out)',
      'text': '/img/figures/BreatherValve.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '1.3.1.  Once the Fuel Breather Valve Lever is turned to OFF, confirm it by clearly stating \'Fuel Breather Valve Lever off\'.',
    },
    {
      'caption': '1.4.    Remove the Spark Plug Cover and Spark Plug Cap.',
      'text': '/img/figures/SparkCover_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '1.4.1.  Remove the Spark Plug Cover in order to access the Spark Plug Cap.',
      'text': '/img/figures/SparkCover_Removal.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '1.4.2.  Remove the Spark Plug Cap.',
      'text': '/img/figures/SparkCap_Removal.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '1.4.3.  Rest the cap on the outside of the Generator and away from the Spark Plug.',
      'text': '/img/figures/SparkCap_Resting.PNG',
      'type': 'image_and_text',
    }],
  },

  {
    'text': '2.  REMOVE AIR CLEANER ASSEMBLY',
    'subtasks': [{
      'caption': '2.1.    Remove the Maintenance Cover.',
      'text': '/img/figures/MaintenanceCover_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '2.1.1.  Loosen the Maintenance Cover Screw.',
      'text': '/img/figures/MaintenanceScrew_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '2.1.1.1.  Use a Flat Head Screwdriver to loosen the Maintenance Cover Screw.',
    },
    {
      'caption': '2.1.2.  Remove the Maintenance Cover.',
      'text': '/img/figures/MaintenanceCover_Removal.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '2.2.    Remove the Air Cleaner Cover and Air Filters.',
      'text': '/img/figures/AirCover_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '2.2.1.  Remove the Air Cleaner Cover Screw.',
      'text': '/img/figures/AirScrew_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '2.2.1.1.  Use a Flat Head Screwdriver to loosen the Air Cleaner Cover Screw.',
    },
    {
      'text': '2.2.2.  Remove the Air Cleaner Cover.',
    },
    {
      'text': '2.2.3.  Remove the Air Filters.',
    },
    {
      'caption': '2.2.3.1.  Pull out both of the Air Filters by hand: the Main Filter (larger, upper filter) and the Outer Filter (small, lower filter).',
      'text': '/img/figures/AirFilters_Labeled.PNG',
      'type': 'image_and_text',
    },
    {
      'text': 'CAUTION: Pry the Breather Tube off gently to avoid damaging it.',
      'type': 'caution',
    },
    {
      'caption': '2.3.    Remove the Breather Tube from the Air Cleaner Case.',
      'text': '/img/figures/BreatherTube_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '2.3.1.  Wrap the Breather Tube in the Rag and grip the Rag and Breather Tube with the Pliers. Gently tug down and away from the Air Cleaner Case with the Pliers while prying the end of the Breather Tube away from the Air Cleaner Case with the Flat Head Screwdriver.',
    },
    {
      'text': '/vid/Breather_Removal.mp4',
      'type': 'video',
    },
    {
      'caption': '2.4.    Remove the Air Cleaner Case and Air Intake Joint Gasket.',
      'text': '/img/figures/AirCase_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '2.4.1.  Remove the 8mm Center Bolt and Flange Nuts securing the Air Cleaner Case to the Generator.',
      'text': '/img/figures/AirCaseNutsBolts_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '2.4.1.1.  Remove these using the Ratcheting Socket Wrench and Socket Set. The 8mm Hex Sockets attaches to the Ratchet through the supplied ¼” Drive.',
    },
    {
      'caption': '2.4.2.  Slide the Air Cleaner Case off of the bolts attached to the Generator.',
      'text': '/img/figures/AirCase_Removal.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '2.4.3.  Slide the Air Intake Joint Gasket off of the bolts attached to the Generator.',
      'text': '/img/figures/AirGasket_Removal.PNG',
      'type': 'image_and_text',
    }],
  },

  {
    'text': '3.  CARBURETOR REMOVAL',
    'subtasks': [{
      'caption': '3.1.    Clamp the Carburetor Fuel Tube.',
      'text': '/img/figures/FuelTube_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '3.1.1.  Clamp the Carburetor Fuel Tube on the right end of the tube that is furthest from the Carburetor using the Hose Pinching Pliers.',
      'text': '/img/figures/FuelTube_Clamped.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '3.2.    Loosen the Carburetor Drain Screw and drain fuel into the Gasoline Container then tighten the Carburetor Drain Screw.',
      'text': '/img/figures/DrainGas_Labeled.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '3.2.1.  Put the Gasoline Container under the Carburetor Drain Tube.',
    },
    {
      'caption': '3.2.2.  Slightly loosen the Carburetor Drain Screw using a Flat Head Screwdriver.',
      'text': '/img/figures/DrainScrew_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '3.2.3.  Tighten the Carburetor Drain Screw using a Flat Head Screwdriver.',
    },
    {
      'text': '3.2.4.  Remove the Gasoline Container.',
    },
    {
      'text': 'CAUTION: Pry the Carburetor Fuel Tube off gently to avoid damaging it.',
      'type': 'caution',
    },
    {
      'caption': '3.3.    Detach the Carburetor Fuel Tube from the Carburetor.',
      'text': '/img/figures/FuelTube_Labeled.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '3.3.1.  Disengage the tension clamp and pull the Carburetor Fuel Tube from its fitting on the Carburetor.',
      'text': '/img/figures/TensionClamp_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '/vid/TensionClamp_Removal.mp4',
      'type': 'video',
    },
    {
      'text': '3.3.1.1.  Disengage the tension clamp by pushing both of the tabs on the clamp toward one another using Pliers. Hold the tabs with the Pliers while sliding the clamp off of the fitting and up the tube.',
    },
    {
      'text': '3.3.1.2.  Pry the Carburetor Fuel Tube from the Carburetor fitting using a Flat Head Screwdriver.',
    },
    {
      'caption': '3.4.    Remove the Carburetor Drain Tube from the Generator.',
      'text': '/img/figures/DrainTube_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '3.4.1.  Pull the bottom of the Carburetor Drain Tube up and out of the Generator housing.',
      'text': '/img/figures/DrainTube_Removal.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '3.4.2.  Remove the Carburetor Drain Tube from its fitting on the Carburetor Bowl.',
      'text': '/img/figures/DrainTubeFitting_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '3.4.2.1.  A Flat Head Screwdriver can be used to pry the Carburetor Drain Tube off of the Carburetor Bowl.',
    },
    {
      'caption': '3.5.    Remove the Right and Left Hand Vent Tubes from the Generator.',
      'text': '/img/figures/VentTubes_Labeled1.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '3.5.1.  Detach the Right Hand Vent Tube from the Carburetor.',
      'caption': '3.5.1.1.  Pull the Right Hand Vent Tube downwards and out of its connection. Leave it in place once disconnected.',
      'text': '/img/figures/VentRight_Detached.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '3.5.2.  Detach the Left Hand Vent Tube from the Carburetor.',
    },
    {
      'caption': '3.5.2.1.  Use a Flat Head Screwdriver to pry the tube off of the fitting. Leave it in place once disconnected.',
      'text': '/img/figures/VentLeft_Detached.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '3.5.3.  Pull the Vent Tubes down and out of the other tubes covering them.',
      'text': '/img/figures/VentTubes_Clear.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '3.5.4.  Pull the connection point of the Vent Tubes up and out of the Generator housing.',
      'text': '/img/figures/VentTubes_Removal.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '3.6.    Remove the Carburetor.',
      'text': '/img/figures/Carb_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '3.6.1.  Slide the Carburetor off of the bolts attached to the Generator.',
      'text': '/img/figures/Carb_Removal.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '3.6.2.  The Carburetor is attached to the Generator through a wire and should be rested next to the Generator as shown in the figure below.',
      'text': '/img/figures/Carb_Placement.PNG',
      'type': 'image_and_text',
    }],
  },

  {
    'text': '4.  FLOAT CHAMBER INSPECTION',
    'subtasks': [{
      'caption': '4.1.    Remove and Inspect the Float Chamber.',
      'text': '/img/figures/FloatChamber_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '4.1.1.  Remove the 10mm Bolt and Washer connecting to the Float Chamber to the Carburetor assembly.',
      'text': '/img/figures/FloatChamberBolt_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '4.1.1.1.  Remove these using the Ratcheting Socket Wrench and Socket Set. The 10mm Hex Sockets attaches directly to the Ratchet.',
    },
    {
      'text': '4.1.2.  Take the Float Chamber off of the Carburetor assembly.',
    },
    {
      'caption': '4.1.3.  Turn the Float Chamber over and inspect it for any deposits or debris.',
      'text': '/img/figures/FloatChamber_Inspect.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '4.2.    Remove the Float Chamber Gasket.',
      'text': '/img/figures/FloatGasket_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '4.2.1.  Remove the Gasket from the Carburetor assembly using the provided Pry Tool.',
    },
    {
      'caption': '4.3.    Remove the Float Securing Pin',
      'text': '/img/figures/FloatPin_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '4.3.1.  Remove the Float Securing Pin by pulling it out with fingers or Needle Nose Pliers.',
    },
    {
      'caption': '4.4.    Remove and Inspect the Float.',
      'text': '/img/figures/Float_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '4.4.1.  Lift the Float up and off of the Carburetor assembly.',
      'text': '/img/figures/Float_Removal.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '4.4.2.  Inspect the Float Valve Tip for wear.',
      'text': '/img/figures/FloatValve_Inspect.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '4.4.3.  Inspect the Float Valve Spring for operation.',
      'text': '/img/figures/FloatSpring_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '4.4.3.1.  Test spring operation by pushing down on the Float Valve Tip.',
    }],
  },

  {
    'text': '5.  FLOAT CHAMBER REASSEMBLY',
    'subtasks': [{
      'caption': '5.1.    Replace the Float and Float Securing Pin.',
      'text': '/img/figures/Float_Replace.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '5.1.1.  Align the joint holes on the Float with the joint holes on the Carburetor assembly.',
      'text': '/img/figures/FloatPin_Align.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '5.1.2.  Insert the Float Securing Pin into the aligned joint holes.',
    },
    {
      'text': '5.2.    Reinsert the Float Chamber Gasket and Reattach the Float Chamber.',
    },
    {
      'caption': '5.2.1.  Reinsert the Float Chamber Gasket.',
      'text': '/img/figures/FloatGasket_Replace.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '5.2.2.  Align the marking on the Float Chamber flange with the marking on the Carburetor assembly.',
      'text': '/img/figures/FloatChamber_Align.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '5.2.3.  Secure the Float Chamber to the Carburetor assembly using the 10mm Bolt and Washer.',
    },
    {
      'text': '5.2.3.1.  Secure the Bolt using the Ratcheting Socket Wrench and Socket Set. The 10mm Hex Socket attaches directly to the Ratchet.',
    }],
  },

  {
    'text': '6.  CARBURETOR REPLACEMENT',
    'subtasks': [{
      'caption': '6.1.    Replace the Carburetor followed by the Right and Left Hand Vent Tubes.',
      'text': '/img/figures/CarbVentTubes_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '6.1.1.  Slide the Carburetor onto the bolts attached to the Generator.',
      'text': '/img/figures/Carb_Replace.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '6.1.2.  Insert the connection point of the Vent Tubes into the Generator housing through the right hand hole on the bottom of the casing.',
      'text': '/img/figures/VentTubes_Replace.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '6.1.3.  Put the Vent Tubes back into position corresponding to the following figure.',
      'text': '/img/figures/VentTubes_Labeled2.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '6.1.3.1.  The following figure ehances the layering of the Vent Tubes.',
      'text': '/img/figures/VentTubesConfig.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '6.1.4.  Reattach the Right Hand Vent Tube to the Carburetor.',
      'text': '/img/figures/VentRight_Detached.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '6.1.4.1.  Push the Right Hand Vent Tube upwards and into its connection tab.',
      'text': '/img/figures/VentRight_Attached.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '6.1.5.  Reattach the Left Hand Vent Tube to the Carburetor.',
      'text': '/img/figures/VentLeft_Detached.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '6.1.5.1.  Push the Left Hand Vent Tube onto the fitting on the Carburetor.',
      'text': '/img/figures/VentLeft_Attached.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '6.2.    Reattach the Carburetor Fuel Tube and remove the Hose Pinching Pliers.',
      'text': '/img/figures/FuelTube_Detached.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '6.2.1.  Push the Carburetor Fuel Tube onto the Carburetor fitting.',
    },
    {
      'text': '6.2.2.  Slide the tension clamp over the Carburetor fitting.',
    },
    {
      'text': '6.2.2.1.  Loosen the tension clamp by pushing both of the tabs on the clamp toward one another using Pliers. Hold the tabs with the Pliers while sliding the clamp onto the fitting.',
    },
    {
      'text': '/vid/TensionClamp_Reattach.mp4',
      'type': 'video',
    },
    {
      'text': '6.2.3.  Remove the Hose Pinching Pliers from the Carburetor Fuel Tube.',
    },
    {
      'text': '6.3.    Replace the Carburetor Drain Tube',
    },
    {
      'caption': '6.3.1.  Insert the unflared end of the Carburetor Drain Tube into the Generator housing through the left hand hole on the bottom of the casing.',
      'text': '/img/figures/DrainTube_Replace1.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '6.3.2.  Reattach the flared end of the Carburetor Drain Tube to the fitting on the Carburetor behind the Left Hand Vent Tube.',
      'text': '/img/figures/DrainTube_Replace2.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '6.3.3.  Check that the layering of the Carburetor Drain Tube, the Right Hand Vent Tube, and Left Hand Vent Tube is correct.',
      'text': '/img/figures/TubeConfig.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '6.4.    Inspect the bottom of the Generator casing for gasoline or tools; clean if necessary.',
    }],
  },

  {
    'text': '7.  AIR CLEANER ASSEMBLY REPLACEMENT',
    'subtasks': [{
      'caption': '7.1.    Replace the Air Intake Joint Gasket and reattach Air Cleaner Case.',
      'text': '/img/figures/CaseGasket_Labeled.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '7.1.1.  Slide the Air Intake Joint Gasket onto the bolts attached to the Generator.',
      'text': '/img/figures/AirGasket_Replace.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '7.1.2.  Slide the Air Cleaner Case onto the bolts attached to the Generator.',
      'text': '/img/figures/AirCase_Replace.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '7.1.3.  Replace the 8mm Center Bolt and Flange Nuts securing the Air Cleaner Case to the Generator.',
      'text': '/img/figures/AirCaseNutsBolts_Replace.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '7.1.3.1.  Replace these using the Ratcheting Socket Wrench and Socket Set. The 8mm Hex Sockets attaches to the Ratchet through the supplied ¼” Drive.',
    },
    {
      'caption': '7.2.    Reattach the Breather Tube and replace the Air Filters and Air Cleaner Cover.',
      'text': '/img/figures/AirFiltersCover_Labeled.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '7.2.1.  Reattach the Breather Tube to the Air Cleaner Case.',
      'text': '/img/figures/BreatherTube_Replace.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '7.2.2.  Replace the Air Filters.',
    },
    {
      'caption': '7.2.2.1.  Insert both of the Air Filters by hand: the Main Filter (larger, upper filter) and the Outer Filter (small, lower filter).',
      'text': '/img/figures/AirFilters_Labeled.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '7.2.3.  Replace the Air Cleaner Cover.',
      'text': '/img/figures/AirCover_Replace.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '7.2.4.  Tighten the Air Cleaner Cover Screw.',
      'text': '/img/figures/AirScrew_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '7.2.4.1.  Use a Flat Head Screwdriver to tighten the Air Cleaner Cover Screw.',
    },
    {
      'caption': '7.3.    Replace the Maintenance Cover.',
      'text': '/img/figures/MaintenanceCover_Replace.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '7.3.1.  Tighten the Maintenance Cover Screw.',
      'text': '/img/figures/MaintenanceScrew_Location.PNG',
      'type': 'image_and_text',
    },
    {
      'text': '7.3.1.1.  Use a Flat Head Screwdriver to tighten the Maintenance Cover Screw.',
    },
    {
      'caption': '7.4.    Replace the Spark Plug Cap and Spark Plug Cover.',
      'text': '/img/figures/SparkCoverCap_Labeled.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '7.4.1.  Replace the Spark Plug Cap.',
      'text': '/img/figures/SparkCap_Replace.PNG',
      'type': 'image_and_text',
    },
    {
      'caption': '7.4.2.  Replace the Spark Plug Cover.',
      'text': '/img/figures/SparkCover_Replace.PNG',
      'type': 'image_and_text',
    }],
  },
  ],
};

/**
 * Recursive function to build procedure steps.
 * @param {object} steps The step object, containing the step's information and any nested steps.
 * @param {string} parent The parent of the step.
 * @param {int} depth The nested depth of the step.
 */
function buildProcedure(steps, parent, depth) {
  steps.forEach(function(step, index) {
    const procID = parent + '_' + index;

    if (step.type == 'image') {
      $('<li id="' + procID + '"><div class="image"><img class="info" src="' + step.text.substr(1) + '"></div></li>').appendTo('ul#' + parent);
    } else if (step.type == 'image_and_text') {
      $('<li id="' + procID + '"><div class="info">' + step.caption + '</div><div class="image"><img class="info" src="' + step.text.substr(1) + '"></div></li>').appendTo('ul#' + parent);
    } else if (step.type == 'image_and_text_and_caution') {
      $('<li id="' + procID + '"><div class="info">' + step.caption + '</div><div class="caution"><div class="info">' + step.caution + '</div></div><div class="image"><img class="info" src="' + step.text.substr(1) + '"></div></li>').appendTo('ul#' + parent);
    } else if (step.type == 'video') {
      $('<li id="' + procID + '"><video class="info" src="' + step.text.substr(1) + '"controls></video></li>').appendTo('ul#' + parent);
    } else if (step.type == 'caution') {
      $('<li id="' + procID + '"><div class="caution">' + step.text + '</div></li>').appendTo('ul#' + parent);
    } else {
      $('<li id="' + procID + '"><div class="info">' + step.text + '</div></li>').appendTo('ul#' + parent);
    }
    if (step.subtasks != undefined) {
      $('<ul id="' + procID + '"></ul').appendTo('li#' + procID);
      buildProcedure(step.subtasks, procID, depth + 1);
    }
  });
}

buildProcedure(proc['PROCEDURE'], 'expList', 0);
